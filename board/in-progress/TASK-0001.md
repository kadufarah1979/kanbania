---
id: TASK-0001
title: "Mapear diferencas entre stage/dev e stage/hml"
project: mdm-terraform
sprint: null
okr: null
priority: high
labels: [infra, research]
story_points: 2
created_at: "2026-02-13T12:00:00-03:00"
created_by: claude-code
assigned_to: claude-code
depends_on: []
blocks: [TASK-0004, TASK-0005]
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-13T12:00:00-03:00"
  - agent: codex
    action: moved-to-in-progress
    date: "2026-02-23T01:16:10-03:00"
  - agent: codex
    action: completed-mapping-and-requested-review
    date: "2026-02-23T01:16:10-03:00"
  - agent: codex
    action: qa-reproved-moved-to-in-progress
    date: "2026-02-23T21:06:16-03:00"
tokens_used: 40863817
tokens_by_phase:
  backlog: 40864108
---

## Descricao

Realizar um mapeamento completo das diferencas entre os arquivos de stage/dev/ e stage/hml/.
Identificar quais arquivos existem no DEV mas estao ausentes no HML, quais tem configuracoes
divergentes, e produzir um inventario de adaptacoes necessarias para espelhar DEV no HML.

Este mapeamento servira como guia para as tarefas TASK-0004 e TASK-0005.

## Criterios de Aceite

- [x] Lista completa de arquivos presentes em stage/dev/ vs stage/hml/
- [x] Identificacao de locals_*.tf ausentes no HML (ex: locals_rds.tf, locals_iot.tf)
- [x] Mapa de valores que precisam ser adaptados (account_id, profile, vpc_cidr, key_pair, dominio, etc.)
- [x] Diferencas em provider versions e backend config documentadas

## Contexto Tecnico

- Diretorio DEV: `/home/carlosfarah/Projects/IaC/MDM/terraform/stage/dev/`
- Diretorio HML: `/home/carlosfarah/Projects/IaC/MDM/terraform/stage/hml/`
- Nao alterar nenhum arquivo, apenas mapear

## Notas de Progresso

- Mapeamento concluido e documentado em `/home/carlosfarah/Projects/IaC/MDM/terraform/stage/DEV_HML_DIFF_TASK-0001.md`.
- Arquivos ausentes no HML identificados: `locals_iot.tf`, `locals_msk.tf`, `locals_rds.tf` (alem de `plan.out`, que e artefato local).
- Divergencias de backend/provider/lockfile e mapa de adaptacoes por ambiente documentados para guiar `TASK-0004` e `TASK-0005`.
- Validacoes executadas:
  - `terraform validate` em `stage/dev`: falhou por erro de plugin local.
  - `terraform validate` em `stage/hml`: falhou solicitando `terraform init`.
- QA (codex) reprovado em 2026-02-23T21:06:16-03:00.
- Pendencias objetivas:
  - `/home/carlosfarah/Projects/IaC/MDM/terraform/stage/dev/modules.tf:118` alteracao fora de escopo (`listeners_rules`) para uma task de mapeamento.
  - `/home/carlosfarah/Projects/IaC/MDM/terraform/stage/dev/locals_load_balancer.tf:52` e `:175` alteracoes funcionais de ALB/apiGateway fora de escopo.
  - `/home/carlosfarah/Projects/IaC/MDM/terraform/.gitignore:41` alteracao fora de escopo (`CODEX.md`, `CLAUDE.md`, `scripts/`).
  - Entregar novamente em branch isolada `task/TASK-0001` contendo apenas artefatos de mapeamento.
