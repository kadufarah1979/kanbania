---
id: TASK-0190
title: "Corrigir acesso API de aplicativos no DEV (ALB/Kong)"
project: mdm-terraform
sprint: null
okr: null
priority: high
labels: [bug, infra, devops]
story_points: 3
created_at: "2026-02-18T12:08:20-03:00"
created_by: "codex"
assigned_to: null
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: "codex"
    action: created
    date: "2026-02-18T12:08:20-03:00"
  - agent: "codex"
    action: claimed
    date: "2026-02-18T12:08:20-03:00"
  - agent: "codex"
    action: update
    date: "2026-02-18T12:12:43-03:00"
  - agent: codex
    action: release
    date: "2026-02-19T16:49:13-03:00"
tokens_used: 3600230
tokens_by_phase:
  backlog: 1162677
---

## Descricao

Restabelecer o acesso da tela `gestao-de-aplicativos/aplicativos` no ambiente DEV, corrigindo roteamento no ALB e encaminhamento no Kong para `api-application`, e formalizar o estado atual para follow-up do erro funcional remanescente.

## Criterios de Aceite

- [x] Rota `api.gateway.dev.mdm-hub.com.br/api-application/*` encaminhada corretamente no ALB para o target group do API Gateway
- [x] Preflight CORS (`OPTIONS`) respondendo 200 com headers adequados no endpoint de `api-application`
- [x] Erro de infraestrutura `502 upstream` removido
- [ ] Tratar/solucionar retorno `422` na listagem de aplicativos sem crash no frontend

## Contexto Tecnico

- Dominio afetado: `https://portal.dev.mdm-hub.com.br/gestao-de-aplicativos/aplicativos`
- API: `https://api.gateway.dev.mdm-hub.com.br/api-application/application?page=1&limit=20`
- Ajustes realizados em runtime:
  - Regra ALB (listener 443) criada para host `api.gateway.dev.mdm-hub.com.br` + path `/api-application/*` com forward para `TG-apiGateway-MDM-DEV`
  - Kong `app-service` e `app-public-service`: `protocol` ajustado de `https` para `http`
- Persistencia no servidor do gateway:
  - `compose/kong-config.yml` atualizado para `protocol: http` nos servicos `app-service` e `app-public-service`
- Estado atual:
  - CORS resolvido
  - Resposta atual da API na tela: `422`
  - Frontend ainda quebra ao receber erro (tratamento de excecao insuficiente)

## Notas de Progresso

### [2026-02-18 12:08] codex
Card criado para registrar os ajustes de infraestrutura ja aplicados e concluir o diagnostico do erro funcional remanescente (`422`) na listagem de aplicativos.

### [2026-02-18 12:12] codex
Task retomada como proxima do board para continuidade de execucao.
