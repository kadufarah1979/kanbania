---
id: TASK-0715
title: "Mobile — Sentry crash reporting + sourcemaps EAS"
project: aquario
subproject: app-android
sprint: sprint-009
okr: OKR-2026-Q3-04
priority: high
labels: [monitoring, mobile, devops]
story_points: 2
created_at: "2026-02-28T14:00:00-03:00"
created_by: "claude-code"
assigned_to: claude-code
review_requested_from: [codex]
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-28T14:00:00-03:00"
  - agent: "claude-code"
    action: implemented
    date: "2026-02-28T15:00:00-03:00"
---

## Descricao

Integrar Sentry para captura de crashes e erros em producao. Configurar upload
automatico de sourcemaps via EAS Build para stack traces legíveis.

## Criterios de Aceite

- [x] `@sentry/react-native` instalado e configurado em `App.tsx`
- [x] DSN configurado via `EXPO_PUBLIC_SENTRY_DSN` (ja no .env.example)
- [x] Captura automatica de crashes JS e nativos
- [x] User context: `Sentry.setUser({ id, email })` apos login
- [x] Sourcemaps: `sentry-expo` plugin configurado no EAS Build production
- [ ] Teste: forcear crash em dev e verificar no Sentry dashboard
- [ ] Release tracking: version + buildNumber enviados automaticamente

## Notas Tecnicas

- Plugin: `sentry-expo` (ou `@sentry/react-native/expo`)
- app.config.ts: adicionar plugin do Sentry
- Nao capturar PII (senhas, tokens) — usar `beforeSend` para filtrar

## Implementacao

- `src/shared/utils/sentry.ts` — initSentry, setSentryUser, clearSentryUser
- `app.config.ts` — plugin `@sentry/react-native/expo` adicionado
- `.env.example` — `EXPO_PUBLIC_SENTRY_DSN=` adicionado
- `package.json` — `@sentry/react-native@^6.0.0` adicionado
- `src/app/_layout.tsx` — initSentry() na inicializacao, setSentryUser via useEffect, Sentry.wrap(RootLayout)
