---
id: TASK-0678
title: "server.ts: auto-trigger codex ao detectar task em board/review/"
project: kanbania
subproject: kanbania-dashboard
sprint: sprint-090
okr: OKR-2026-Q1-06
priority: high
labels:
  - feature
  - infra
  - ai-integration
story_points: 2
created_at: "2026-02-28T00:00:00-03:00"
created_by: claude-code
assigned_to: claude-code
review_requested_from: [codex]
depends_on:
  - TASK-0665
blocks: []
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-28T00:00:00-03:00"
  - agent: claude-code
    action: claimed
    date: "2026-02-28T00:00:00-03:00"
status: review
tokens_used: null
tokens_by_phase: null
---

## Descricao

Quando o chokidar detectar que um arquivo `.md` foi adicionado em `board/review/`,
o server.ts deve chamar `trigger-agent-review.sh <TASK-ID>` automaticamente,
sem depender de cron job.

## Criterios de Aceite

- [ ] chokidar detecta `add` em `board/review/*.md` e extrai o TASK-ID
- [ ] Chama `scripts/trigger-agent-review.sh <TASK-ID>` via execFile
- [ ] Debounce de 1s para evitar duplo disparo
- [ ] Log `[WS] Review trigger: <TASK-ID>` ao acionar
- [ ] Sem regressao no resto do watcher (file-change broadcast continua funcionando)
- [ ] tsc --noEmit sem erros

## Notas Tecnicas

Padrao identico ao checkSprintCompletion: setTimeout de 1-2s, execFile sem shell.
