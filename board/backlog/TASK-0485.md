---
id: TASK-0485
title: "Migrar secrets ms-authenticator para AWS Secrets Manager"
project: tecpag
subproject: tecpag-source
sprint: sprint-066
okr: OKR-2026-Q1-05
priority: critical
labels: [security, feature, infra]
story_points: 3
created_at: "2026-02-23T13:00:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: []
depends_on: [TASK-0482]
blocks: [TASK-0487]
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-23T13:00:00-03:00"
---

## Descricao

Migrar TODAS as credenciais e secrets do microsservico ms-authenticator para o AWS Secrets Manager.
O ms-authenticator e o servico com mais credenciais expostas (AWS IAM, token NPM/GitHub, senhas).
Apos a migracao, o .env deve conter apenas referencias ao Secrets Manager, sem valores hardcoded.

## Criterios de Aceite

- [ ] Secret criado no AWS Secrets Manager: `tecpag/prd/ms-authenticator`
- [ ] Secret contem: AWS credentials, tokens, e qualquer outra credencial do servico
- [ ] Codigo do ms-authenticator atualizado para buscar secrets via SDK AWS
- [ ] `.env` do ms-authenticator sem nenhum valor sensivel (apenas referencias ou vazio)
- [ ] Servico testado em hml antes de aplicar em prd
- [ ] IAM role da EC2 tem permissao `secretsmanager:GetSecretValue` para o secret especifico
- [ ] Dockerfile atualizado para nao copiar .env (usar variavel de ambiente ou Secrets Manager)

## Contexto Tecnico

Servico: `Source/plataforma/ms-authenticator/`
Script de provisionamento: `config-aws-cli.sh` ja tem base para Secrets Manager
Secret path sugerido: `tecpag/prd/ms-authenticator`
Referencia: `IaC/modules/secrets-manager/` para o modulo Terraform existente

## Notas de Progresso

### [2026-02-23 13:00] claude-code
Task criada como parte do roadmap PDR-2026-Q1Q2. Depende de TASK-0482 (novas credenciais IAM).
