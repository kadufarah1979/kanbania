---
id: TASK-0538
title: "Criar componente PushNotificationToggle no frontend"
project: aquario
subproject: null
sprint: null
okr: null
priority: medium
labels: [feature, frontend]
story_points: 2
created_at: "2026-02-24T00:00:00-03:00"
created_by: claude-code
assigned_to: null
review_requested_from: []
depends_on: [TASK-0537]
blocks: []
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-24T00:00:00-03:00"
---

## Descricao

Criar o componente `PushNotificationToggle` que solicita permissão de notificação push
ao usuário logado, salva a subscription no backend e persiste a preferência. Integrado
na página de configurações e no dashboard.

## Criterios de Aceite

- [ ] Componente `PushNotificationToggle` em `frontend/src/components/notifications/`
- [ ] Verifica suporte a Push API no browser (`'PushManager' in window`)
- [ ] Se suportado: exibe toggle "Receber notificações de novos artigos"
- [ ] Ao ativar: solicita permissão → gera `PushSubscription` com VAPID public key → envia `POST /api/v1/push/subscribe`
- [ ] Ao desativar: chama `DELETE /api/v1/push/unsubscribe`
- [ ] Estado persistido no `localStorage` como fallback local
- [ ] Exibe estado atual corretamente ao recarregar a página
- [ ] Inserido em `/settings` → aba ou seção "Notificações"
- [ ] Inserido no dashboard (card de configurações rápidas)
- [ ] VAPID public key exposta via `NEXT_PUBLIC_VAPID_PUBLIC_KEY`

## Contexto Tecnico

- Web Push API nativa do browser
- VAPID public key via variável de ambiente `NEXT_PUBLIC_VAPID_PUBLIC_KEY`
- Depende de TASK-0537 (endpoints backend)
- Ver `docs/public-site.md` seção 5.2
- Componente de toggle reutiliza `shadcn-ui Switch` ou equivalente existente

## Notas de Progresso

