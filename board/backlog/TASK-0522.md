---
id: TASK-0522
title: "Criar stage deploy-prd no CI/CD com aprovacao manual obrigatoria"
project: tecpag
subproject: tecpag-devops
sprint: sprint-070
okr: OKR-2026-Q2-09
priority: high
labels: [devops, infra, feature]
story_points: 3
created_at: "2026-02-23T13:00:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: []
depends_on: [TASK-0515]
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-23T13:00:00-03:00"
---

## Descricao

Adicionar stage de deploy em producao ao pipeline CI/CD, com aprovacao manual obrigatoria
antes de qualquer deploy em prd. Implementar rollback automatico em caso de falha.

## Criterios de Aceite

- [ ] Stage `deploy-prd` adicionado ao pipeline com `when: manual`
- [ ] Aprovacao exige pelo menos 1 aprovador autorizado
- [ ] Health check apos deploy: se falhar, rollback automatico
- [ ] Notificacao no Slack/Discord: inicio do deploy, sucesso e falha
- [ ] Log de deploy auditavel (quem aprovou, quando, qual versao)
- [ ] Testado com deploy real em prd (janela de manutencao)

## Contexto Tecnico

Depende de TASK-0515 (pipeline base com deploy-hml)
GitLab protected environments para prd

## Notas de Progresso

### [2026-02-23 13:00] claude-code
Depende de TASK-0515. Sprint 070.
