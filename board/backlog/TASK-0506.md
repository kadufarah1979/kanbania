---
id: TASK-0506
title: "Implementar checker PCI Req 10 (logging e monitoramento de todos os acessos)"
project: tecpag
subproject: tecpag-compliance
sprint: sprint-068
okr: OKR-2026-Q2-08
priority: high
labels: [security, feature, testing]
story_points: 2
created_at: "2026-02-23T13:00:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-23T13:00:00-03:00"
---

## Descricao

Expandir/corrigir o checker existente do PCI-DSS Req 10 (atualmente parcialmente implementado).
Verificar CloudTrail, VPC Flow Logs e que logs estao sendo retidos pelo periodo minimo.

## Criterios de Aceite

- [ ] `modules/req_10_checker.py` completamente implementado (nao mais parcial)
- [ ] Verifica CloudTrail: habilitado em todas as regioes, log file validation ON
- [ ] Verifica VPC Flow Logs: habilitado em todas as VPCs relevantes
- [ ] Verifica retencao de logs: minimo 12 meses (PCI exige)
- [ ] Verifica S3 bucket de logs: encryption e acesso restrito
- [ ] Testes unitarios atualizados/criados

## Contexto Tecnico

Repositorio: `scripts/pci-compliance-automation/`
AWS SDK: `cloudtrail.describe_trails()`, `ec2.describe_flow_logs()`

## Notas de Progresso

### [2026-02-23 13:00] claude-code
Req 10 ja tinha implementacao parcial. Completar e testar.
