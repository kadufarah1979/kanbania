---
id: TASK-0277
title: "Configurar GitLab Runner no Bastion PRD (ARM64)"
project: onmidia
sprint: sprint-037
okr: null
priority: high
labels: [infra, devops]
story_points: 3
created_at: "2026-02-20T12:10:00-03:00"
created_by: claude-code
assigned_to: null
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-20T12:10:00-03:00"
tokens_used: 470541
tokens_by_phase:
  review: 138399
---

## Descricao

Executar o script `DevOps/setup-runner-prd.sh` no Bastion PRD para configurar o GitLab Runner com executor shell em arquitetura ARM64 (Graviton).

O script realiza:
1. Instalacao de pacotes base (curl, git, jq, unzip)
2. Instalacao do Docker + adicao do usuario ao grupo docker
3. Instalacao do Node.js 18 via NodeSource (ARM64)
4. Instalacao do AWS CLI v2 (ARM64)
5. Instalacao e registro do GitLab Runner (executor shell, tag `bastion-prd`)
6. Configuracao do servico gitlab-runner com working directory em /home/gitlab-runner

Requer: token de runner do GitLab (Settings > CI/CD > Runners > New project runner).

## Criterios de Aceite

- [ ] Script executado com sucesso no Bastion PRD via SSH (`sudo bash setup-runner-prd.sh`)
- [ ] `gitlab-runner verify` retorna runner ativo e conectado ao GitLab
- [ ] `gitlab-runner list` exibe runner com tag `bastion-prd`
- [ ] Docker, Node.js 18 e AWS CLI v2 instalados e funcionais na instancia
- [ ] Pipeline de teste executado com sucesso usando o runner registrado

## Contexto Tecnico

- Script: `DevOps/setup-runner-prd.sh`
- GitLab URL: `https://git.lab.tectoylabs.com.br`
- Tag do runner: `bastion-prd`
- Executor: shell (bash)
- Arquitetura: aarch64 (Graviton)
- Config: `/etc/gitlab-runner/config.toml` (concurrent=4, limit=4)
- Acesso SSH ao Bastion PRD: ver `docs/ssh-access.md`

## Notas de Progresso

### [2026-02-20 12:10] claude-code
Task criada com base no script DevOps/setup-runner-prd.sh.
