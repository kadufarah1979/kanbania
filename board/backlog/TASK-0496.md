---
id: TASK-0496
title: "Corrigir containers rodando como root nos servicos criticos"
project: tecpag
subproject: tecpag-devops
sprint: sprint-067
okr: OKR-2026-Q1-05
priority: high
labels: [security, devops]
story_points: 3
created_at: "2026-02-23T13:00:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-23T13:00:00-03:00"
---

## Descricao

Multiplos docker-compose.yml tem `user: "0"` (root), o que viola o principio de minimo privilegio
e aumenta o impacto de qualquer comprometimento do container.
Identificar os servicos criticos e alterar para usuarios nao-privilegiados.

## Criterios de Aceite

- [ ] Levantamento completo de todos os `user: "0"` nos docker-compose.yml
- [ ] Containers de gateway e plataforma rodando com usuario nao-root (uid >= 1000)
- [ ] Containers de banco de dados revisados (alguns podem precisar de root por design)
- [ ] Containers testados e funcionando apos mudanca de usuario
- [ ] Documentar os containers que NECESSITAM root e justificar

## Contexto Tecnico

Busca: `grep -r 'user: "0"' DevOps/`
Impacto: multiplos servicos conforme analise `02-ANALISE-SEGURANCA-PCI.md`

## Notas de Progresso

### [2026-02-23 13:00] claude-code
Task criada como parte do roadmap PDR-2026-Q1Q2.
