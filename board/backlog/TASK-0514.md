---
id: TASK-0514
title: "Implementar checker PCI Req 7 (restricao de acesso a componentes por necessidade)"
project: tecpag
subproject: tecpag-compliance
sprint: sprint-069
okr: OKR-2026-Q2-08
priority: high
labels: [security, feature, testing]
story_points: 2
created_at: "2026-02-23T13:00:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-23T13:00:00-03:00"
---

## Descricao

Implementar checker do PCI-DSS Req 7: acesso a componentes do sistema restrito apenas
a quem tem necessidade de negocio. Verificar IAM policies, SCPs e resource-based policies.

## Criterios de Aceite

- [ ] `modules/req_07_checker.py` implementado
- [ ] Verifica IAM policies: nenhuma com `"Action": "*"` sem condicoes
- [ ] Verifica S3 bucket policies: sem acesso publico em buckets sensiveis
- [ ] Verifica RDS: sem acesso publico (`PubliclyAccessible=false`)
- [ ] Verifica Security Groups: sem regras excessivamente permissivas
- [ ] Testes unitarios criados

## Contexto Tecnico

Repositorio: `scripts/pci-compliance-automation/`
Depende dos resultados de TASK-0501 (IAM minimo privilegio)

## Notas de Progresso

### [2026-02-23 13:00] claude-code
Task criada. Sprint 069.
