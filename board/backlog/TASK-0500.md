---
id: TASK-0500
title: "Integrar checkov no pipeline IaC GitLab"
project: tecpag
subproject: tecpag-iac
sprint: sprint-067
okr: OKR-2026-Q1-05
priority: high
labels: [security, infra, devops]
story_points: 2
created_at: "2026-02-23T13:00:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: []
depends_on: []
blocks: [TASK-0509, TASK-0515]
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-23T13:00:00-03:00"
---

## Descricao

Adicionar job de validacao com `checkov` no pipeline GitLab CI para analise de seguranca
dos arquivos Terraform e Docker Compose. Complementa o tfsec (TASK-0499).

## Criterios de Aceite

- [ ] Job `checkov-scan` adicionado ao `.gitlab-ci.yml`
- [ ] Cobre: arquivos `.tf` (Terraform) e `docker-compose.yml`
- [ ] Pipeline falha em findings CRITICAL
- [ ] Relatorio SARIF exportado como artifact
- [ ] Checks de PCI-DSS habilitados no checkov (framework `pci_dss`)

## Contexto Tecnico

Ferramenta: `checkov` (https://www.checkov.io/)
Comando: `checkov -d . --framework terraform,dockerfile,docker_compose --check CKV_* --output sarif`
PCI framework: `checkov -d . --framework terraform --compliance pci_dss`

## Notas de Progresso

### [2026-02-23 13:00] claude-code
Task criada. Executar junto com TASK-0499 â€” complementares.
