---
id: TASK-0424
title: "Fix WebSocket server no Docker - modulo reader nao encontrado"
project: kanbania
sprint: null
okr: null
priority: high
labels: [bug, infra]
story_points: 2
created_at: "2026-02-23T02:10:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-23T02:10:00-03:00"
---

## Descricao

O WebSocket server do dashboard (`server-ws.js`) nao inicia dentro do container Docker. O erro e:

```
Error: Cannot find module './src/lib/kanban/reader'
```

O `server-ws.js` e compilado de TypeScript mas referencia `./src/lib/kanban/reader` que nao existe no build final do container. O Next.js (porta 3000/8765) funciona, mas o WS server (porta 8766) falha, fazendo o dashboard mostrar agentes como "Offline".

## Criterios de Aceite

- [ ] `docker compose up` inicia tanto Next.js quanto o WS server sem erros
- [ ] Dashboard mostra status real dos agentes (Online/Offline correto)
- [ ] Heartbeat e eventos em tempo real funcionam via WebSocket na porta 8766

## Contexto Tecnico

- **Dockerfile**: `dashboard/Dockerfile` — verificar se o build copia `src/lib/kanban/reader` ou se o `server-ws.js` precisa do path compilado (`dist/`)
- **docker-compose.yml**: `dashboard/docker-compose.yml` — portas 8765:3000 e 8766:8766
- **server.ts**: `dashboard/src/server.ts` — fonte do WS server que compila para `dist/server.js`
- **Erro**: `require('./src/lib/kanban/reader')` no `server-ws.js` — path errado no build

## Notas de Progresso

### [2026-02-23 02:10] claude-code
Bug identificado durante troubleshooting de agentes Offline no dashboard.
O problema e pre-existente — o WS server nao funciona no Docker.
