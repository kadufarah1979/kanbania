---
id: TASK-0552
title: "Configurar origins no painel Akamai para ALB HML"
project: mdm-terraform
subproject: null
sprint: sprint-076
okr: null
priority: high
labels:
  - infra
story_points: 2
created_at: "2026-02-24T00:00:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: []
depends_on: []
blocks:
  - TASK-0555
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-24T00:00:00-03:00"
---

## Descricao

No painel Akamai Control Center, configurar o origin de cada property para apontar ao ALB público HML na porta 443 com o Host header correto.

Configurações por property:

| Property | Origin | Host Header |
|----------|--------|-------------|
| api.media.hml.mdm-hub.com.br | ALB-public-MDM-HML-780696821.us-east-1.elb.amazonaws.com:443 | api.media.hml.mdm-hub.com.br |
| api.mdm.hml.mdm-hub.com.br | ALB-public-MDM-HML-780696821.us-east-1.elb.amazonaws.com:443 | api.mdm.hml.mdm-hub.com.br |
| api.gateway.hml.mdm-hub.com.br | ALB-public-MDM-HML-780696821.us-east-1.elb.amazonaws.com:443 | api.gateway.hml.mdm-hub.com.br |
| Demais domínios públicos | ALB-public-MDM-HML-780696821.us-east-1.elb.amazonaws.com:443 | hostname correspondente |

**Esta etapa deve ser concluída ANTES do terraform apply (TASK-0555)** para garantir que o tráfego seja encaminhado corretamente após a mudança.

## Criterios de Aceite

- [ ] Origin do api.media configurado para ALB HML porta 443 com Host header correto
- [ ] Origin do api.mdm configurado para ALB HML porta 443 com Host header correto
- [ ] Origin do api.gateway configurado para ALB HML porta 443 com Host header correto
- [ ] Demais domínios públicos configurados no Akamai com origins corretos
- [ ] Configurações ativadas (deployed) no Akamai Control Center
- [ ] Teste de conectividade Akamai -> ALB bem-sucedido (sem erro de origem)

## Contexto Tecnico

Tarefa operacional no painel Akamai Control Center (não é Terraform).

ALB público HML: `ALB-public-MDM-HML-780696821.us-east-1.elb.amazonaws.com`

O Akamai atua como WAF/CDN na frente do ALB. O fluxo será:
- Usuário -> Akamai (edge) -> ALB HML:443 -> Target Group -> EC2/ASG

O Host header enviado pelo Akamai para o ALB deve ser o hostname do serviço (não o hostname do ALB), para que a regra `host_header` do listener 443 funcione corretamente.

## Notas de Progresso

### [2026-02-24 00:00] claude-code
Card criado. Tarefa operacional no painel Akamai. Bloqueia TASK-0555 (deve ser concluída antes do apply).
