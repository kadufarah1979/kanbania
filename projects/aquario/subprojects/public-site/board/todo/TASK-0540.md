---
id: TASK-0540
title: "Implementar preferencias de categoria de noticias do usuario"
project: aquario
subproject: public-site
sprint: sprint-075
okr: null
priority: medium
labels: [feature, backend, frontend, database]
story_points: 3
created_at: "2026-02-24T00:00:00-03:00"
created_by: claude-code
assigned_to: null
review_requested_from: []
depends_on: [TASK-0534, TASK-0537]
blocks: [TASK-0535, TASK-0536, TASK-0538, TASK-0539]
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-24T00:00:00-03:00"
---

## Descricao

Implementar o sistema de preferências de categoria de artigos do usuário: migration
para adicionar campos ao model `User`, endpoint de atualização e UI em `/settings`.
Essas preferências filtram o widget do dashboard, a newsletter e as notificações push.

## Criterios de Aceite

- [ ] Migration Alembic adiciona `blog_categories: ARRAY[TEXT]`, `notify_email: BOOL`, `notify_push: BOOL` ao model `User`
- [ ] `PATCH /api/v1/users/me/preferences` aceita e persiste os campos acima
- [ ] `GET /api/v1/users/me` retorna os novos campos
- [ ] UI em `/settings` → seção "Notificações e Conteúdo":
  - [ ] Checkboxes por categoria (fundamentos, marinho, agua-doce, plantado, equipamentos, saude)
  - [ ] Toggles "Receber por e-mail" e "Receber notificação push"
  - [ ] Salva automaticamente (debounce 500ms) ou via botão "Salvar preferências"
- [ ] Lista vazia `[]` em `blog_categories` = "todas as categorias"
- [ ] Newsletter job (TASK-0536) e push (TASK-0537) consultam essas preferências ao enviar

## Contexto Tecnico

- Migration em `backend/alembic/versions/`
- Schema atualizado em `backend/app/schemas/user.py`
- Endpoint em `backend/app/api/v1/users.py`
- UI em `frontend/src/app/(authenticated)/settings/page.tsx`
- Ver `docs/public-site.md` seção 5.4

## Notas de Progresso

