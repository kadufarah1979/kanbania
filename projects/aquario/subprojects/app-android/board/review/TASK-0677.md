---
id: TASK-0677
title: "Mobile — Biometria: expo-local-authentication toggle"
project: aquario
subproject: app-android
sprint: sprint-004
okr: OKR-2026-Q2-11
priority: low
labels: [feature, mobile, security]
story_points: 2
created_at: "2026-02-28T14:00:00-03:00"
created_by: "claude-code"
assigned_to: "claude-code"
review_requested_from: [codex]
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-28T14:00:00-03:00"
  - agent: "claude-code"
    action: implemented
    date: "2026-02-28T17:00:00-03:00"
---

## Descricao

Adicionar opcao de autenticacao biometrica (digital/face) para desbloqueio rapido do app.
Quando habilitada, o app solicita biometria ao voltar do background em vez de exigir senha.

## Criterios de Aceite

- [x] Toggle "Usar Biometria" em ProfileScreen > Configuracoes de Seguranca
- [x] Verificar suporte: `LocalAuthentication.hasHardwareAsync()` + `isEnrolledAsync()`
- [x] Se nao suportado: toggle desabilitado com mensagem explicativa
- [x] Quando ativado: persistir preferencia em MMKV (`biometric_enabled: bool`)
- [x] Ao abrir o app (AppState foreground): solicitar biometria se habilitado
- [x] Fallback para PIN/senha se biometria falhar 3 vezes

## Notas Tecnicas

- Package: `expo-local-authentication` (ja listado em app.config.ts)
- Armazenar em authStore ou em store dedicado: `securityStore`
- Nao exigir biometria se o token ainda e valido e o app acabou de ser aberto

## Implementacao

- `mobile/src/shared/stores/securityStore.ts` — Zustand + MMKV para `biometricEnabled`
- `mobile/src/app/screens/user/ProfileScreen.tsx` — secao Seguranca com Switch + verificacao de hardware
- `mobile/src/app/_layout.tsx` — hook `useBiometricLock` com AppState listener + BiometricLockScreen
