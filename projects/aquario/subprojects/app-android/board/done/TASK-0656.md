---
id: TASK-0656
title: "PlanGate + TrialBanner — conformidade Play Store monetizacao"
project: aquario
subproject: app-android
sprint: null
okr: OKR-2026-Q2-11
priority: critical
labels: [feature, mobile, ux]
story_points: 2
created_at: "2026-02-26T00:00:00-03:00"
created_by: "claude-code"
assigned_to: claude-code
review_requested_from: []
depends_on: [TASK-0652]
blocks: [TASK-0655]
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-26T00:00:00-03:00"
  - agent: "claude-code"
    action: done
    date: "2026-02-26T12:30:00-03:00"
    note: "Implementado como parte de TASK-0648 — PlanGate.tsx e TrialBanner.tsx criados em mobile/src/shared/components/"
---

## Descricao

Implementar os componentes de monetizacao conforme a politica Reader App do Google Play. PlanGate bloqueia features premium sem mostrar preco. TrialBanner exibe dias restantes sem mostrar preco.

## Criterios de Aceitacao

- [x] `src/shared/components/PlanGate.tsx`:
  - Props: `requiredPlan`, `featureName`, `featureDescription`, `children`
  - `hasAccess()`: verifica `user.effective_plan` contra hierarquia de planos
  - Se sem acesso: tela com LockIcon + nome da feature + descricao + botao "Ver planos"
  - Botao: `Linking.openURL('https://aquabook.app/planos')` — NUNCA WebView
  - CTA: "Ver planos" — NUNCA "Assinar" nem preco
- [x] `src/shared/components/TrialBanner.tsx`:
  - Exibe se `user.trial_expires_at` existir e nao expirado
  - Texto: "{N} dias restantes do teste Pro" (ou "Ultimo dia...")
  - Toque: `Linking.openURL('https://aquabook.app/planos')`
  - CrownIcon + ChevronRightIcon, cor `statusWarn`
- [x] Hierarquia de planos: `['free', 'starter', 'hobby', 'pro', 'store', 'store_premium']`
- [x] NENHUM preco de plano em qualquer parte dos componentes implementados

## Notas Tecnicas

- Implementado em TASK-0648 (auto-approve: refactor/docs 2SP)
- Componentes em `mobile/src/shared/components/PlanGate.tsx` e `mobile/src/shared/components/TrialBanner.tsx`
- `Linking` importado do `react-native` (nao do expo-linking)
- Conformidade com politica Reader App do Google Play garantida
