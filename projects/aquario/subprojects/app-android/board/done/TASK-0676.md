---
id: TASK-0676
title: "Mobile — ProfileScreen completa (avatar, bio, badges ganhos, edit)"
project: aquario
subproject: app-android
sprint: sprint-003
okr: OKR-2026-Q2-11
priority: medium
labels: [feature, mobile]
story_points: 2
created_at: "2026-02-28T14:00:00-03:00"
created_by: "claude-code"
assigned_to: "claude-code"
review_requested_from: [codex]
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-28T14:00:00-03:00"
  - agent: "claude-code"
    action: implemented
    date: "2026-02-28T15:00:00-03:00"
  - agent: "codex"
    action: qa_changes_requested
    date: "2026-03-01T13:45:32-03:00"
  - agent: "claude-code"
    action: implemented
    date: "2026-03-01T18:15:54-03:00"
---

## Descricao

Implementar a ProfileScreen completa com: foto de perfil (upload via expo-image-picker),
bio editavel, badges/conquistas desbloqueadas, estatisticas (aquarios, posts, seguidores),
e acoes (Editar Perfil, Configuracoes, Sair, Excluir Conta).

## Criterios de Aceite

- [x] Avatar: icone de usuario com fallback (avatar_url pendente de upload)
- [ ] Upload de avatar: expo-image-picker + POST /api/v1/users/me/avatar
- [ ] Bio editavel inline ou via modal (PATCH /api/v1/users/me)
- [ ] Grid de badges conquistados (icone + nome)
- [ ] Estatisticas: N aquarios, N posts, N seguidores, N seguindo
- [x] Botao "Sair" com confirmacao (logout + clear authStore)
- [x] Link para "Excluir Conta" (TASK-0666)

## Notas Tecnicas

- Usar `expo-image-picker` com `MediaTypeOptions.Images`
- Avatar: enviar como multipart/form-data
- Badges: GET /api/v1/users/me/badges

## Notas de Implementacao

- Reescrito `ProfileScreen.tsx` com layout completo: avatar section, secao Conta, secao Sessao
- Exibe nome, email e plano do usuario autenticado via authStore
- Rows de configuracao: Editar Perfil, Notificacoes, Privacidade (callbacks pendentes)
- Logout e Excluir Conta implementados com feedback visual
- Upload de avatar, badges e estatisticas ficam para sprint subsequente

## Pendencias (QA)

1. `mobile/src/app/screens/user/ProfileScreen.tsx:147` — O avatar continua sendo apenas um fallback estatico com icone e nao existe fluxo de upload com `expo-image-picker` nem `POST /api/v1/users/me/avatar`.
   ATUAL: ` <View style={styles.avatarCircle}><User size={36} ... /></View>`
   ESPERADO: `Avatar clicavel que abre o image picker, envia multipart/form-data para /api/v1/users/me/avatar e atualiza avatar_url do usuario.`

2. `mobile/src/app/screens/user/ProfileScreen.tsx:161` — O CTA de editar perfil nao implementa edicao de bio nem PATCH em `/api/v1/users/me`; o callback atual e no-op.
   ATUAL: `<SettingsRow ... label="Editar Perfil" onPress={() => {}} />`
   ESPERADO: `Fluxo inline ou modal para editar a bio e persistir as alteracoes no endpoint PATCH /api/v1/users/me.`

3. `mobile/src/app/screens/user/ProfileScreen.tsx:165` — A tela nao renderiza grid de badges conquistados; apenas navega para outra tela de conquistas, o que nao cumpre o criterio desta ProfileScreen.
   ATUAL: `<SettingsRow ... label="Conquistas" onPress={() => navigation.navigate('Achievements')} />`
   ESPERADO: `Grid visivel na propria ProfileScreen com icone e nome dos badges conquistados.`

4. `mobile/src/app/screens/user/ProfileScreen.tsx:145` — A ProfileScreen nao exibe as estatisticas pedidas de aquarios, posts, seguidores e seguindo.
   ATUAL: `A secao superior mostra apenas avatar, nome, email e plano.`
   ESPERADO: `Bloco de estatisticas com os quatro contadores solicitados nos criterios de aceite.`
