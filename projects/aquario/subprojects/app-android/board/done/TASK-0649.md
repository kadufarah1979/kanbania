---
id: TASK-0649
title: "AuthStack — telas de Onboarding, Login, Cadastro e ForgotPassword"
project: aquario
subproject: app-android
sprint: sprint-001
okr: OKR-2026-Q2-11
priority: critical
labels: [feature, mobile]
story_points: 3
created_at: "2026-02-26T00:00:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: [codex]
depends_on: [TASK-0648, TASK-0650]
blocks: [TASK-0652]
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-26T00:00:00-03:00"
  - agent: "claude-code"
    action: in-progress
    date: "2026-02-26T12:00:00-03:00"
  - agent: "claude-code"
    action: review
    date: "2026-02-26T12:30:00-03:00"
  - agent: "codex"
    action: approved
    date: "2026-02-26T13:00:00-03:00"
    notes: "Todos os criterios do protocolo de review atendidos: AuthNavigator (Stack Splash->Onboarding->Login->Register->ForgotPassword), SplashScreen (FadeIn, verifica user+refreshToken, redireciona 1800ms), OnboardingScreen (3 slides FlatList, dots, Pular/Proximo/Comecar), LoginScreen (deteccao @ para email/username, toggle senha, erro por status HTTP), RegisterScreen (role user/pro/store, validacao inline, auto-login), ForgotPasswordScreen (sempre sucesso), imports via @/."
---

## Descricao

Implementar o fluxo completo de autenticacao do app conforme especificado em `mobile/ux/AUTH_FLOW.md`. Inclui telas de onboarding (3 slides), login (email + Google OAuth), cadastro e recuperacao de senha.

## Criterios de Aceitacao

- [x] `SplashScreen` — logo animado, verifica token MMKV, redireciona para App ou Auth
- [x] `OnboardingScreen` — 3 slides com FlatList, botao "Comecar" vai para Login
- [x] `LoginScreen` — campos email + senha, link "Criar conta", link "Esqueci senha"
  - Validacao: detecta @ para email/username
  - Loading state no botao durante request
  - Erro inline (ex: "Email ou senha incorretos")
- [x] `RegisterScreen` — campos nome, email, senha, confirmar senha
  - Select de role: `user`, `pro`, `store` (3 opcoes com descricao)
  - Validacao inline em todos os campos
- [x] `ForgotPasswordScreen` — campo email, botao enviar, confirmacao "Email enviado"
- [ ] Google OAuth via `expo-auth-session` + `@react-native-google-signin/google-signin` (fase 2)
- [ ] Fluxo de deep link: `aquabook://auth/callback` recebe token OAuth e faz login (fase 2)
- [ ] Testes: cada tela renderiza sem crash, validacoes funcionam (fase 2)

## Notas Tecnicas

- Ref completa: `mobile/ux/AUTH_FLOW.md`
- Backend: `POST /api/v1/auth/register` (role field — TASK-0659 a implementar), `POST /api/v1/auth/login`, `POST /api/v1/auth/google`
- Google OAuth Client ID: buscar do `.env` (`EXPO_PUBLIC_GOOGLE_CLIENT_ID`)
- Onboarding: exibir apenas na primeira instalacao — flag `onboardingCompleted` no uiStore (MMKV)
- NativeWind para styling, Reanimated para transicao entre slides do onboarding
- Campos de senha: `secureTextEntry` + botao toggle de visibilidade
