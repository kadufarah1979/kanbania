---
id: TASK-0665
title: "Mobile — Google Sign-In: integrar resposta backend + store tokens"
project: aquario
subproject: app-android
sprint: sprint-002
okr: OKR-2026-Q2-11
priority: high
labels: [feature, mobile, auth]
story_points: 2
created_at: "2026-02-28T14:00:00-03:00"
created_by: "claude-code"
assigned_to: "claude-code"
review_requested_from: [codex]
depends_on: [TASK-0664]
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-28T14:00:00-03:00"
  - agent: "claude-code"
    action: implemented
    date: "2026-02-28T15:00:00-03:00"
  - agent: "codex"
    action: qa_changes_requested
    date: "2026-02-28T19:04:48-03:00"
---

## Descricao

Receber a resposta do backend apos Google Sign-In (access_token + refresh_token + user),
armazenar no authStore (Zustand + MMKV) e navegar para o UserNavigator.
Tratar o caso de primeiro acesso (usuario novo) vs re-login.

## Criterios de Aceite

- [x] authStore.setUser() chamado com dados retornados pelo backend
- [x] access_token e refresh_token salvos no MMKV
- [x] Navegacao automatica para UserNavigator apos sucesso
- [x] Em caso de erro (403, 500), exibir mensagem clara
- [ ] Teste unitario RNTL cobrindo o fluxo de sucesso e erro

## Notas Tecnicas

- Backend retorna: `{ access_token, refresh_token, user: { id, name, email, role } }`
- authStore ja possui `setUser()` e `setTokens()` — usar esses metodos
- Apos setUser, RootNavigator detecta automaticamente o role e navega

## Notas de Implementacao

- `handleGoogleSuccess` em `LoginScreen.tsx` chama `POST /api/v1/auth/google`, depois `GET /api/v1/auth/me`
- `setTokens` e `setUser` do authStore chamados em sequencia apos sucesso
- Erro exibido no mesmo `errorBox` do formulario de email/senha
