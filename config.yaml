# =============================================================================
# config.yaml — Configuração Global do Sistema Kanban
# =============================================================================

# Identificacao do sistema
system:
  name: "kanbania"
  language: "pt-BR"

# Proprietário do sistema
owner:
  name: "kadufarah"
  timezone: "America/Sao_Paulo"

# Agentes autorizados
agents:
  - id: "claude-code"
    name: "Claude Code"
    provider: "Anthropic"
    role: "implementer"
    color: "#f97316"
    wip_limit: 2
  - id: "codex"
    name: "Codex"
    provider: "OpenAI"
    role: "reviewer"
    color: "#10b981"
    exec_command: "codex exec --full-auto -C {{working_dir}} --add-dir {{kanban_root}}"
    wip_limit: 1

# Configuração de Sprints
sprint:
  duration_days: 14              # Duração padrão do sprint em dias
  default_capacity: 21           # Story points padrão por sprint
  naming_pattern: "sprint-NNN"   # Padrão de nomenclatura

# Configuração do Board
board:
  columns:
    - id: "backlog"
      name: "Backlog"
      description: "Tarefas identificadas, aguardando priorização"
    - id: "todo"
      name: "To Do"
      description: "Priorizadas para o sprint atual"
    - id: "in-progress"
      name: "In Progress"
      description: "Em execução por um agente"
    - id: "review"
      name: "Review"
      description: "Aguardando QA do codex (gate para done ou reprovacao)"
    - id: "done"
      name: "Done"
      description: "Concluídas e aprovadas"

# Prioridades disponíveis (ordem de precedência)
priorities:
  - id: "critical"
    name: "Critical"
    order: 1
  - id: "high"
    name: "High"
    order: 2
  - id: "medium"
    name: "Medium"
    order: 3
  - id: "low"
    name: "Low"
    order: 4

# Story Points (escala Fibonacci)
story_points:
  allowed: [1, 2, 3, 5, 8, 13]
  max_single_task: 3             # >= 3 SP: avaliar quebra se tocar > 3 arquivos
  epic_threshold: 5              # >= 5 SP: obrigatoriamente decomposta em sub-tasks
  max_files_per_task: 5          # Task que altera > 5 arquivos: deve ser quebrada

# Workflow de transicoes e triggers
workflow:
  transitions:
    - from: "backlog"
      to: "todo"
      allowed_roles: [implementer, reviewer]
    - from: "todo"
      to: "in-progress"
      allowed_roles: [implementer]
    - from: "in-progress"
      to: "review"
      allowed_roles: [implementer]
    - from: "review"
      to: "done"
      allowed_roles: [reviewer]
    - from: "review"
      to: "in-progress"
      allowed_roles: [reviewer]
  triggers:
    - on: "enter_review"
      action: "exec_reviewer"
      description: "Ao mover para review, notificar e acionar o agente reviewer"
    - on: "reject"
      action: "exec_implementer"
      description: "Ao rejeitar (review->in-progress), notificar agente implementer para rework"

# Labels padrão disponíveis
labels:
  - bug
  - feature
  - refactor
  - docs
  - infra
  - security
  - performance
  - ux
  - research
  - ai-integration
  - testing
  - devops

# OKR
okr:
  max_objectives_per_quarter: 3
  kr_per_objective:
    min: 2
    max: 4

# Caminhos do sistema (relativos à raiz do kanban)
paths:
  board: "board"
  okrs: "okrs"
  sprints: "sprints"
  projects: "projects"
  templates: "templates"
  logs: "logs"

# Projetos (gates de qualidade por tipo de stack)
# Paths ficam em config.local.yaml (gitignored)
projects:
  aquario:
    name: "Aquario"
    description: "Projeto aquario — exemplo de configuracao de gates"
    gates:
      backend:
        detect: "requirements.txt"
        commands:
          - "pytest"
          - "mypy ."
      frontend:
        detect: "package.json"
        commands:
          - "tsc --noEmit"
          - "npm run build"

# Subprojetos
# Projetos com subprojetos têm board/sprints/okrs próprios por subprojeto.
# Adicionar entrada aqui quando um projeto for migrado para estrutura com subprojetos.
# Estrutura: projects/<proj>/subprojects/<sub>/{board,sprints,okrs}/
subprojects:
  enabled: true
  # Projetos que usam subprojetos (listar slugs):
  projects_with_subprojects:
    - kanbania
    - tecpag

# Integracao com X (Twitter)
# Credenciais ficam em config.local.yaml (gitignored).
x_integration:
  enabled: true
  tweet_template: "✅ {title}\n\n#{project} #kanbania #buildinpublic"
  only_labels: ""
