# TASK-0033: Implementar wizard criação aquário + aquarium switcher

## Identidade
- Agente: codex
- Projeto: /home/carlosfarah/Projects/aquario
- Kanban: /home/carlosfarah/kanbania

## Card

```yaml+markdown
---
id: TASK-0033
title: "Implementar wizard criação aquário + aquarium switcher"
project: aquario
sprint: sprint-005
okr: OKR-2026-Q1-01
priority: high
labels: [feature, ux]
story_points: 3
created_at: "2026-02-14T10:00:00-03:00"
created_by: claude-code
assigned_to: codex
depends_on: [TASK-0029]
blocks: []
acted_by:
  - agent: codex
    action: reassigned
    date: "2026-02-14T10:15:59-03:00"
  - agent: claude-code
    action: created
    date: "2026-02-14T10:00:00-03:00"
---

## Descrição

Implementar wizard de criação de aquário e dropdown para trocar aquário ativo.

Componentes:
- `components/dashboard/aquarium-create-wizard.tsx` — wizard: tipo → subtipo → volume → confirma
- `components/dashboard/aquarium-switcher.tsx` — dropdown no header para trocar aquário

Página: `app/(authenticated)/aquariums/new/page.tsx`

## Critérios de Aceite

- [ ] Wizard multi-step: tipo (marine/freshwater) → subtipo → volume → nome → confirma
- [ ] Ícones e descrições para cada tipo/subtipo
- [ ] Ao finalizar, cria aquário via API e redireciona ao dashboard
- [ ] Aquarium switcher no header lista todos os aquários do usuário
- [ ] Trocar aquário atualiza todo o dashboard
- [ ] Se usuário sem aquário, redireciona para wizard automaticamente

## Contexto Técnico

- API: POST /api/v1/aquariums
- API: GET /api/v1/aquariums
- Store: aquarium-store.ts (aquário ativo persistido)

## Notas de Progresso
```

## Dependencias

- TASK-0029: backlog

## Workflow

1. Se a task NAO esta em `in-progress/`: mover de `backlog/` para `in-progress/`, adicionar `acted_by` com `action: claimed`
2. Implementar no projeto `/home/carlosfarah/Projects/aquario` conforme os criterios de aceite
3. Fazer commit no projeto com mensagem descritiva
4. Adicionar nota de progresso no card em `/home/carlosfarah/kanbania/board/in-progress/TASK-0033.md`
5. Mover card: `mv /home/carlosfarah/kanbania/board/in-progress/TASK-0033.md /home/carlosfarah/kanbania/board/review/TASK-0033.md`
6. Adicionar `acted_by` com `action: request_review` e `review_requested_from: [claude-code]` no frontmatter
7. Append em `/home/carlosfarah/kanbania/logs/activity.jsonl`
8. Fazer commit no kanban

## Formato Commit Projeto

```
feat(wizard-criao-aqurio): descricao concisa - TASK-0033
```

## Formato Commit Kanban

```
[KANBAN] <action> TASK-0033: <descricao>
```

## Formato Log

```json
{"timestamp":"<ISO>","agent":"codex","action":"<claimed|request_review>","entity_type":"task","entity_id":"TASK-0033","details":"<descricao>","project":"aquario"}
```

## Contexto Tecnico

- API: POST /api/v1/aquariums
- API: GET /api/v1/aquariums
- Store: aquarium-store.ts (aquário ativo persistido)

## Instrucoes Importantes

- NAO leia arquivos de protocolo (CODEX.md, AGENTS.md, config.yaml, sprints/current.md). TUDO que voce precisa esta NESTE arquivo.
- Foque em IMPLEMENTAR. Nao gaste tokens com leituras desnecessarias.
- Se a task ja foi claimada (esta em in-progress/), va direto para o passo 2 (implementar).
- Ao terminar, SEMPRE mova para review/ e registre no log.

## Nota de Progresso (QA)

### [2026-02-14 17:10] codex (QA)

QA: **changes requested** (gate final).

Resultado da revisao:
- Criterios funcionais atendidos no codigo (`wizard`, `switcher`, `redirect para /dashboard`, guard de onboarding no dashboard).
- Gate `npx tsc --noEmit` passou (exit 0).
- Gate `npm run build` falhou neste workspace com erro generico: `Build failed because of webpack errors` (sem erro raiz, inclusive com `DEBUG=next:build:*`).

Passos objetivos:
1. Reexecutar build sem worker para capturar erro raiz (`experimental.webpackBuildWorker: false` em `next.config.js`) e corrigir a causa.
2. Validar `npm run build` 2x seguidas apos o ajuste.

Observacao de fluxo:
- QA pendente de review do claude-code (nao ha `acted_by` do claude-code com `approved/changes_requested` no card fornecido).
- Nao movi o card.
