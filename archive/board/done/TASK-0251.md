---
id: TASK-0251
title: "Frontend: indicadores de status do sistema na dashboard"
project: aquario
sprint: sprint-032
okr: OKR-2026-Q1-01
priority: low
labels: [feature, frontend, ux]
story_points: 2
created_at: "2026-02-19T22:30:00-03:00"
created_by: claude-code
assigned_to: codex
review_requested_from: [codex]
depends_on: [TASK-0248]
blocks: []
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-19T22:30:00-03:00"
  - agent: codex
    action: claimed
    date: "2026-02-19T15:12:52-03:00"
  - agent: claude-code
    action: claimed
    date: "2026-02-19T16:26:00-03:00"
  - agent: claude-code
    action: move
    date: "2026-02-19T16:27:00-03:00"

  - agent: codex
    action: complete
    date: "2026-02-19T17:02:36-03:00"
tokens_used: 1851097
tokens_by_phase:
  in_progress: 1554839
  review: 67394
---

## Descricao

Adicionar indicadores visuais na dashboard principal mostrando o status de conectividade do sistema: conexao MQTT, ultimo heartbeat do device, e status geral dos servicos (consumindo o endpoint /health do TASK-0248).

## Criterios de Aceite

- [x] Badge de status na topbar ou dashboard (verde/amarelo/vermelho)
- [x] Tooltip ou dropdown com detalhes: DB ok, MQTT ok, ultimo heartbeat
- [x] Atualiza automaticamente a cada 30 segundos
- [x] Estado offline/degraded exibido com alerta visual
- [x] Testes para o componente de status (min 2 testes)

## Contexto Tecnico

- Depende do endpoint /health (TASK-0248)
- Usar polling simples (setInterval) ou SWR
- Componente reutilizavel para topbar layout

## Notas de Progresso

### [2026-02-19 16:27] claude-code

Implementacao ja estava completa (iniciada por codex). Validacao feita:

- `SystemHealthBadge` em `components/dashboard/system-health-badge.tsx`: badge com tons ok/warn/crit/off, dropdown com DB, MQTT e Heartbeat
- `lib/api/health.ts`: tipos e chamada ao endpoint `/health`
- Integrado na dashboard (`page.tsx` L293-298) com polling de 30s (L195-201)
- Alerta visual para estado degradado (L110-115)
- 2 testes passando: cenario saudavel e cenario degradado
- Cores Tailwind customizadas (`status-ok`, `status-warn`, `status-crit`) configuradas no `tailwind.config.ts`
