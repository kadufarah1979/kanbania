---
id: TASK-0117
title: "Livestock: seed de categorias e especies"
sprint: sprint-014
priority: high
points: 3
assigned_to: null
status: done
review_requested_from: [codex]
tags: [backend, seed, livestock]
depends_on: [TASK-0115, TASK-0116]
created_at: "2026-02-15T22:30:00-03:00"
created_by: claude-code
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-15T22:30:00-03:00"
  - agent: codex
    action: qa_changes_requested
    date: "2026-02-16T00:00:00-03:00"
  - agent: claude-code
    action: moved_to_review
    date: "2026-02-16T03:30:00-03:00"
  - agent: codex
    action: qa_approved
    date: "2026-02-15T23:42:00-03:00"
tokens_used: 2157652
tokens_by_phase:
  backlog: 77058
  in_progress: 1966701
---

## Descricao

Seed data para categorias (20) e especies (100+): peixes marinhos (50+), corais (30+), invertebrados (20+). Arquivo `backend/app/data/livestock_seed.py`, funcao idempotente `seed_livestock(db)`.

## Criterios de Aceite

- [x] 20 categorias seedadas
- [x] 50+ especies de peixes marinhos com dados completos
- [x] 30+ especies de corais com dados de light/flow/growth
- [x] 20+ invertebrados marinhos
- [x] Script/funcao de seed idempotente
- [x] Dados de compatibilidade basicos (incompatible_with)

## Pendencias (ultimo QA)

1. `incompatible_with` armazena nomes cientificos em vez de UUIDs; check de compatibilidade compara UUIDs (`livestock_service.py:545,553`), bloqueios nao disparam
2. Check reef-safe verifica `cat.code in ("coral", "anemone")` mas categorias seedadas sao `coral_sps`, `coral_lps`, `coral_soft` â€” warnings nao disparam (`livestock_service.py:583,592`)
3. Seed atual: 7 categorias e 35 especies (abaixo do criterio)

## Referencia

- `docs/dev/LIVESTOCK.md` secoes 3, 5

## Notas de Progresso (QA fix)

**2026-02-16 03:30** - QA feedback corrigido:
- Service agora usa `scientific_name` para matching de `incompatible_with` (em vez de UUIDs)
- Implementada constante `_CORAL_CATEGORY_CODES` para reef-safe checks que inclui coral_sps, coral_lps, coral_soft
- Seed expandido: 20 categorias e 113 especies (56 peixes, 36 corais, 21 invertebrados)
- Todos os criterios de aceite atendidos

**2026-02-15 23:42** - QA: aprovado (gate results: PASSED)
