---
id: TASK-0211
title: "Implementar reinício de instância com bloqueio PRD e confirmação obrigatória"
project: consoleai
sprint: null
okr: null
priority: critical
labels: [feature, aws, security, operations]
story_points: 5
created_at: "2026-02-18T16:53:59-03:00"
created_by: "codex"
assigned_to: codex
review_requested_from: [codex]
depends_on: [TASK-0203, TASK-0209]
blocks: [TASK-0212]
acted_by:
  - agent: "codex"
    action: created
    date: "2026-02-18T16:53:59-03:00"
  - agent: "codex"
    action: update
    date: "2026-02-19T16:07:47-03:00"
  - agent: "codex"
    action: update
    date: "2026-02-19T18:20:59-03:00"
  - agent: "codex"
    action: claim
    date: "2026-02-20T15:11:11-03:00"
  - agent: "codex"
    action: update
    date: "2026-02-20T15:34:12-03:00"
  - agent: "codex"
    action: qa_approved
    date: "2026-02-20T17:20:28-03:00"
tokens_used: 1912572
tokens_by_phase:
  todo: 237329
---

## Descricao

Adicionar ação de reiniciar instância EC2 para usuários autorizados, com confirmação explícita, validação de tenant e bloqueio absoluto de execução em ambiente PRD.

## Criterios de Aceite

- [x] Ação de restart disponível apenas para perfis autorizados
- [x] Restart em recursos PRD é sempre negado pelo backend
- [x] Operação exige confirmação explícita e motivo de execução

## Contexto Tecnico

Atende necessidade operacional sem violar regra de governança de produção.

## Notas de Progresso

### [2026-02-18 16:53] codex
Card criado com foco em controle operacional e segurança.

### [2026-02-20 15:34] codex
Validação concluída no código da API/serviço operacional com confirmação obrigatória (`RESTART`), motivo obrigatório, autorização por tenant e bloqueio de escrita em PRD.
Testes executados no projeto `consoleAI`:
- `.venv/bin/python -m pytest -q tests/unit/test_consoleai_api.py -k "instance_restart"` -> 3 passed
- `.venv/bin/python -m pytest -q tests/unit/test_authz.py` -> 9 passed

### [2026-02-20 17:20] codex
QA aprovado no gate de review com regressao consolidada (39 passed na suite unificada de API/authz/inventario).
