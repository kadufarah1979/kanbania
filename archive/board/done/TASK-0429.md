---
id: TASK-0429
title: "Dashboard - extrair computeSprintStats() para eliminar duplicacao"
project: kanbania
sprint: sprint-061
priority: high
labels: [refactor]
story_points: 2
created_at: "2026-02-22T12:30:00-03:00"
created_by: "claude-code"
assigned_to: "claude-code"
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-22T12:30:00-03:00"
  - agent: "claude-code"
    action: claimed
    date: "2026-02-22T20:00:00-03:00"
  - agent: "claude-code"
    action: auto-approved
    date: "2026-02-22T20:30:00-03:00"
---

## Descricao

Logica de calcular totalPoints, completedPoints, tasksByStatus, totalTokens e
tokensByPhase e copy-paste entre 4 rotas de API. Extrair para funcao utilitaria.

## Criterios de Aceite

- [x] Funcao `computeSprintStats(sprint, tasks)` em `src/lib/kanban/reader.ts` ou modulo separado
- [x] Rotas refatoradas: `/api/sprints`, `/api/sprint/[id]`, `/api/sprint/current`, `/api/okr/[id]`
- [x] Mesma resposta JSON que antes (sem breaking changes)
- [x] Build sem erros

## Contexto Tecnico

Duplicacao em:
- `src/app/api/sprints/route.ts` linhas 23-55
- `src/app/api/okr/[id]/route.ts` linhas 25-57
- `src/app/api/sprint/[id]/route.ts` linhas 17-19
- `src/app/api/sprint/current/route.ts` linhas 12-13
