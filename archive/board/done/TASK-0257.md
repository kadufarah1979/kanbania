---
id: TASK-0257
title: "Testar ambiente PRD via portal e AWS CLI"
project: onmidia
sprint: sprint-034
okr: null
priority: high
labels: [infra]
story_points: 8
created_at: "2026-02-19T14:38:42-03:00"
created_by: "claude-code"
assigned_to: claude-code
review_requested_from: []
depends_on: []
blocks: [TASK-0258]
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-19T14:38:42-03:00"
tokens_used: 1571091
tokens_by_phase:
  backlog: 1553137
---

## Descricao

Testar o ambiente PRD em funcionamento para identificar erros de runtime, problemas de CORS e outras falhas operacionais. Duas frentes:

**1. Teste via portal:**
- Acessar https://portal.onmidia.amazonasinovare.com.br/login
- Credenciais: root@email.com / on-midia@2025
- Testar fluxos criticos do sistema
- Capturar erros de CORS, timeouts, falhas de conectividade
- Verificar console do navegador para erros de rede

**2. Validacao via AWS CLI:**
- ALB health checks e target group status
- CloudWatch logs recentes (erros 4xx/5xx)
- Certificados ACM (validade, dominio)
- DNS resolution (Route53)
- S3 bucket policies e CORS configs
- Security group rules efetivas
- ASG instance health

## Criterios de Aceite

- [ ] Portal PRD acessado e testado com credenciais fornecidas
- [ ] Erros de CORS capturados e documentados (endpoints, headers, origem)
- [ ] Health checks do ALB verificados
- [ ] Logs do CloudWatch analisados para erros recentes
- [ ] Certificados SSL validados
- [ ] DNS resolution confirmada
- [ ] Todos os achados registrados com evidencias

## Contexto Tecnico

- URL: https://portal.onmidia.amazonasinovare.com.br/login
- AWS Profile: verificar em ~/.aws/credentials para o stage prd
- Regiao: us-east-1
- Restricao: nao analisar codigo-fonte, apenas infraestrutura e comportamento do sistema

## Notas de Progresso

- 2026-02-19: Validacao via AWS CLI (profile ONMIDIA-PRD). Findings: 5 TGs unhealthy (apiCertificate, apiIot, apiMailer, konga, portal:3000), S3 sem CORS, CORS preflight 404, 7 secrets sem rotacao, portal response 1.4s. Portal HTTPS acessivel (200). Testes web limitados (ambiente CLI, sem browser).
