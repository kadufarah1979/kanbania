---
id: TASK-0133
title: "Teste: livestock/page.tsx (inventory com tabs e actions)"
project: aquario
sprint: sprint-016
points: 2
priority: medium
status: review
assigned_to: null
review_requested_from: [codex]
depends_on: [TASK-0127]
created_at: "2026-02-16T03:00:00-03:00"
created_by: claude-code
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-16T03:00:00-03:00"
  - agent: claude-code
    action: claimed
    date: "2026-02-16T11:36:00-03:00"
  - agent: claude-code
    action: review_requested
    date: "2026-02-16T12:17:00-03:00"
  - agent: codex
    action: qa_changes_requested
    date: "2026-02-16T12:18:01-03:00"
  - agent: claude-code
    action: fix_applied
    date: "2026-02-16T12:48:00-03:00"
  - agent: claude-code
    action: review_requested
    date: "2026-02-16T12:48:00-03:00"
  - agent: codex
    action: qa_approved
    date: "2026-02-16T12:50:10-03:00"
tokens_used: 1299510
tokens_by_phase:
  backlog: 76402
  in_progress: 1223115
---

## Descricao

Criar testes para a pagina principal `livestock/page.tsx`.

## Testes Requeridos

- Mostra "Nenhum aquario selecionado" sem activeAquariumId
- Mostra loading spinner enquanto carrega
- Mostra erro quando fetchLivestock falha
- Mostra empty state quando sem livestock
- Renderiza SummaryCards com total_alive, total_deceased, total_investment
- Renderiza tabs com contagens (Todos, Peixes, Corais, Invertebrados, Falecidos, Removidos)
- Filtrar por tab mostra items corretos
- Botao "+ Adicionar" abre LivestockAddDialog
- Card actions: Detalhes navega, Obito abre DeceasedDialog, Remover abre RemovalDialog
- Items deceased/removed com opacity reduzida

## Criterios de Aceite

- [x] `src/__tests__/pages/livestock-page.test.tsx` (16 testes)
- [x] Mock de router, stores e API
- [x] Testa filtros de tabs
- [x] Testa interacoes com cards
- [x] `npm run test` passa (15/15)

## QA Fix

1. Teste "renders category tabs with correct counts" agora valida count badges (3 para Todos, 1 para Peixes/Corais/Falecidos, 0 para Invertebrados/Removidos).
2. Adicionado teste "filters items when tab is clicked" â€” clica Peixes (mostra so Nemo), Corais (so Acropora), Falecidos (so Peixe Morto), Todos (todos 3).

## Notas de Progresso

- 15 testes: no aquarium, loading, error, empty state, title, summary cards, tabs with counts, livestock cards, add dialog, detail navigation, deceased dialog, removal dialog, opacity-60, hidden actions for deceased, fetchLivestock called on mount
- Mocks: next/navigation (useRouter), aquarium-store, livestock-store, livestock API, child dialog components (LivestockAddDialog, DeceasedDialog, RemovalDialog)
