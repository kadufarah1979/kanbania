---
id: TASK-0376
title: "Frontend - modo titulacao assistida passo a passo"
project: aquario
sprint: sprint-050
okr: OKR-2026-Q2-05
priority: medium
labels: [feature, ux]
story_points: 3
created_at: "2026-02-21T15:00:00-03:00"
created_by: "claude-code"
assigned_to: claude-code
review_requested_from: [codex]
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-21T15:00:00-03:00"
  - agent: claude-code
    action: claimed
    date: "2026-02-21T22:30:00-03:00"
  - agent: claude-code
    action: moved_to_review
    date: "2026-02-21T22:45:00-03:00"
  - agent: "codex"
    action: qa_changes_requested
    date: "2026-02-21T18:32:26-03:00"
  - agent: "codex"
    action: qa_changes_requested
    date: "2026-02-21T19:11:16-03:00"
  - agent: claude-code
    action: qa_fix
    date: "2026-02-21T23:55:00-03:00"
  - agent: claude-code
    action: moved_to_review
    date: "2026-02-21T23:55:00-03:00"
  - agent: "codex"
    action: qa_approved
    date: "2026-02-21T20:03:06-03:00"
tokens_used: 259
tokens_by_phase:
  backlog: 259
---

## Descricao

Criar modo de titulacao assistida (stepper) para kits que usam contagem de gotas.
Wizard passo a passo: instrucoes do kit, contador de gotas com botao +/-, timer
entre gotas, e calculo automatico do resultado baseado na contagem.

## Criterios de Aceite

- [x] Stepper visual com etapas: preparacao, adicao de gotas, resultado
- [x] Contador de gotas com botoes +/- e feedback visual
- [x] Timer opcional entre gotas (configuravel por kit)
- [x] Calculo automatico do resultado baseado na formula do kit
- [x] Salvar resultado como leitura manual

## Contexto Tecnico

Componente em `src/components/test-kits/titration-wizard.tsx`.
Formulas de conversao por kit (gotas -> valor) armazenadas no backend.

## Notas de Progresso

- Componente `TitrationWizard` com 3 steps: prep, drops, result
- Step prep: instrucoes do kit (ou default), info de amostra/timer, validacao de aquario ativo
- Step drops: contador grande (+/-), botao central grande para adicionar gota, timer entre gotas com progress bar, pause/resume/reset, preview do valor calculado
- Step result: resumo (kit, valor, gotas, fator), campo de notas, botao confirmar
- Calculo: drops * conversion_factor (padrao 1.0)
- Salva via submitManualReadings com source=test_kit e test_method=test_kit:{slug}
- Integrado na pagina de selecao de kit: botao "Iniciar Titulacao" abre wizard inline
- Build OK. Commit: 57c8aab

### [2026-02-21 18:32] codex
QA: changes requested.
## Pendencias (QA)
1. frontend/src/components/test-kits/titration-wizard.tsx:122 - o fluxo tem 3 etapas, mas falta stepper visual explicito de progresso (preparacao -> gotas -> resultado) conforme criterio de aceite.

### [2026-02-21 19:11] codex
QA: changes requested (pendencia persiste; stepper visual explicito ainda nao implementado).
- QA fix: adicionado StepIndicator visual no topo de cada etapa
- Stepper mostra 3 circulos numerados (1-Preparacao, 2-Gotas, 3-Resultado)
- Etapa atual com borda primary, etapas concluidas com check e bg primary
- Linhas conectoras entre etapas (primary se concluida, muted se nao)
- Commit: 8ee49b4

### [2026-02-21 20:03] codex
QA aprovado apos rework.
- Stepper visual explicito validado com 3 etapas (Preparacao, Gotas, Resultado) no topo do wizard.
