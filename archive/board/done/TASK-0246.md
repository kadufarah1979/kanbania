---
id: TASK-0246
title: "Frontend: formulario de criacao/edicao de regras schedule"
project: aquario
sprint: sprint-032
okr: OKR-2026-Q1-01
priority: high
labels: [feature, frontend]
story_points: 5
created_at: "2026-02-19T22:30:00-03:00"
created_by: claude-code
assigned_to: codex
review_requested_from: [codex]
depends_on: []
blocks: []
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-19T22:30:00-03:00"
  - agent: codex
    action: claimed
    date: "2026-02-19T14:24:43-03:00"
  - agent: codex
    action: moved_to_review
    date: "2026-02-19T14:42:16-03:00"
  - agent: codex
    action: qa_approved
    date: "2026-02-19T14:43:18-03:00"
tokens_used: 1573668
tokens_by_phase:
  in_progress: 1553663
---

## Descricao

O backend ja suporta regras de automacao do tipo "schedule" (TASK-0240), mas o formulario frontend (AutomationRuleForm) so permite criar regras de sensor. Adicionar suporte completo para criar e editar regras schedule com campos de horario.

## Criterios de Aceite

- [x] AutomationRuleForm exibe selector de rule_type: "sensor" | "schedule"
- [x] Ao selecionar "schedule", exibe campos: start_time, end_time, days_of_week
- [x] Campo opcional de cron_expression para usuarios avancados
- [x] Selector de timezone (default: America/Sao_Paulo)
- [x] Validacao: start_time < end_time, pelo menos 1 dia selecionado
- [x] Edicao de regra schedule existente carrega campos corretamente
- [x] Testes unitarios para o formulario schedule (min 5 testes)

## Contexto Tecnico

- Componente: `frontend/src/components/automation/automation-rule-form.tsx`
- Store: `frontend/src/stores/automation-store.ts`
- API: `frontend/src/lib/api/automation.ts`
- Backend ja aceita rule_type "schedule" no CRUD

## Notas de Progresso

- 2026-02-19T14:42:16-03:00 codex: validado suporte completo schedule no formulario e execucao de testes unitarios (`npm test -- src/__tests__/components/automation-rule-form.test.tsx`) com 8/8 passando.
- 2026-02-19T14:43:18-03:00 codex: QA concluido; card aprovado e movido para done.
