---
id: TASK-0434
title: "Dashboard - leitura reversa eficiente do activity.jsonl"
project: kanbania
sprint: sprint-061
priority: medium
labels: [performance]
story_points: 2
created_at: "2026-02-22T12:30:00-03:00"
created_by: "claude-code"
assigned_to: "claude-code"
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-22T12:30:00-03:00"
  - agent: "claude-code"
    action: auto-approved
    date: "2026-02-22T19:10:00-03:00"
---

## Descricao

getActivity() em reader.ts le o activity.jsonl inteiro em memoria, faz reverse e
slice. A rota /api/insights chama getActivity(10000). Implementar leitura reversa
eficiente que leia apenas as ultimas N linhas.

## Criterios de Aceite

- [ ] getActivity(limit) le apenas as ultimas `limit` linhas do arquivo
- [ ] Abordagem: ler do final do arquivo com fs.read + seek, ou usar readline reverso
- [ ] /api/insights nao precisa mais de getActivity(10000) — usar abordagem incremental
- [ ] Build sem erros

## Contexto Tecnico

- `src/lib/kanban/reader.ts` linhas 241-248 — getActivity atual
- `src/app/api/insights/route.ts` linha 171 — getActivity(10000)
- AGENTS.md secao 11.6: "Ler activity.jsonl com tail -20, nunca o arquivo completo"
