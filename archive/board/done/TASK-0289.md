---
id: TASK-0289
title: "Criar scripts/lib/config.sh"
project: kanbania
sprint: sprint-039
okr: OKR-2026-Q2-01
priority: high
labels: [infra,refactor]
story_points: 8
created_at: "2026-02-21T22:00:00-03:00"
created_by: "claude-code"
assigned_to: null
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-21T22:00:00-03:00"
tokens_used: 849
tokens_by_phase:
  backlog: 849
---

## Descricao

Criar a biblioteca bash que todos os scripts vao consumir. Usa yq (binario Go) para parse YAML. Auto-detecta KANBAN_ROOT via git rev-parse --show-toplevel. Faz deep merge de config.yaml + config.local.yaml.

Funcoes obrigatorias:
- cfg <yq-path> [default] — le config.yaml com merge do local
- get_columns — array de IDs de colunas
- get_agent_role [id] — role do agente (implementer/reviewer/both/pm)
- get_reviewers — IDs dos agentes com role reviewer
- can_transition <from> <to> — valida permissao de transicao
- get_project_path <slug> — path do config.local.yaml
- get_project_worktree <slug> [agent] — worktree do config.local.yaml
- notify <urgency> <title> <body> — plugavel (none/notify-send/slack/webhook)
- Auto-detecta AGENT via $KB_AGENT ou primeiro agente no config

Estimativa: ~100 linhas de bash.

## Criterios de Aceite

- [ ] Arquivo scripts/lib/config.sh criado
- [ ] Funcao cfg() le valores do config.yaml
- [ ] Deep merge com config.local.yaml funciona
- [ ] get_columns() retorna array de colunas do config
- [ ] get_agent_role() retorna role correta
- [ ] get_reviewers() retorna lista de revisores
- [ ] can_transition() valida transicoes permitidas
- [ ] get_project_path() e get_project_worktree() leem config.local.yaml
- [ ] notify() funciona com provider none (noop)
- [ ] Auto-deteccao de KANBAN_ROOT via git

## Contexto Tecnico

Referencia: open-source/ROADMAP_OPEN_SOURCE.md e open-source/PLANO_OPEN_SOURCE.md

## Notas de Progresso
