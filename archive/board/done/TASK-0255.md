---
id: TASK-0255
title: "Workflow: retry manual de sync Kanban para solicitacoes aprovadas com falha"
project: consoleai
sprint: sprint-034
okr: null
priority: high
labels: [backend, workflow, kanban]
story_points: 5
created_at: "2026-02-19T14:01:48-03:00"
created_by: codex
assigned_to: codex
review_requested_from: []
depends_on: []
blocks: []
acted_by:
  - agent: codex
    action: created
    date: "2026-02-19T14:01:48-03:00"
  - agent: codex
    action: claimed
    date: "2026-02-19T14:17:35-03:00"
  - agent: codex
    action: update
    date: "2026-02-19T14:19:19-03:00"
  - agent: codex
    action: complete
    date: "2026-02-19T14:20:05-03:00"
tokens_used: 1553743
tokens_by_phase:
  backlog: 1553137
---

## Descricao

Entrega atomica da sprint-034 para evolucao operacional do ConsoleAI.

## Criterios de Aceite

- [x] Implementacao concluida conforme titulo do card.
- [x] Comportamento validado por testes automatizados ou evidencia funcional.
- [x] Sem regressao de autorizacao multi-tenant e guardrail PRD.

## Contexto Tecnico

Escopo restrito ao projeto `consoleai`, preservando Design System e regras de seguranca existentes.

## Notas de Progresso

### [2026-02-19T14:01:48-03:00] codex
Task criada no planejamento da sprint-034.

### [2026-02-19T14:17:35-03:00] codex
Task claimada e movida para in-progress para execucao.

### [2026-02-19T14:19:19-03:00] codex
Implementacao concluida:
- `src/consoleai/workflow_service.py`: adicionado `retry_task_request_sync` para retry manual de um request especifico com validacoes de permissao e estado de sync.
- `src/app.py`: botao de retry manual exibido para gestor em requests aprovados com sync falho.
- `tests/test_workflow_service.py`: novos testes cobrindo retry manual com sucesso e bloqueio quando sync nao esta falho.

Evidencia:
- `env PYTHONPATH=src .venv/bin/python -m unittest -q tests.test_workflow_service tests.test_workflow_ui`
- Resultado: 19 testes OK.

### [2026-02-19T14:20:05-03:00] codex
QA de gate em review:
- `env PYTHONPATH=src .venv/bin/python -m unittest -q tests.test_workflow_service tests.test_workflow_ui tests.test_ui_provider_mode`
- Resultado: 23 testes OK. Card aprovado para done.
