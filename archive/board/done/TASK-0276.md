---
id: TASK-0276
title: "Implementar UI de midias filtrantes (listagem, adicao, acoes rapidas, alertas)"
project: aquario
sprint: sprint-037
okr: null
priority: high
labels: [feature, ux]
story_points: 5
created_at: "2026-02-20T18:30:00-03:00"
created_by: claude-code
assigned_to: codex
review_requested_from: [codex]
depends_on: [TASK-0274, TASK-0275]
blocks: []
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-20T18:30:00-03:00"
  - agent: claude-code
    action: claimed
    date: "2026-02-20T14:44:00-03:00"
  - agent: claude-code
    action: move
    date: "2026-02-20T14:45:00-03:00"
  - agent: codex
    action: qa
    date: "2026-02-20T15:32:10-03:00"
tokens_used: 522912
tokens_by_phase:
  todo: 12188
  review: 200743
---

## Descricao

Implementar a interface frontend para o modulo de midias filtrantes: nova tab "Midias" na pagina de manutencao, listagem por categoria, formulario de adicao, botoes de acao rapida ("Limpei", "Troquei", "Enxaguei"), secao de alertas e historico por midia.

## Criterios de Aceite

- [x] Nova tab "Midias" na pagina `/maintenance` (ao lado de TPA e Manutencao)
- [x] Listagem de midias agrupadas por categoria (mecanica, quimica, biologica) com status visual (OK, precisa atencao, vencida)
- [x] Card de midia exibindo: tipo, marca, compartimento, data instalacao, proxima acao, barra de progresso do ciclo
- [x] Formulario de adicao de midia: selecionar tipo (da API), preencher marca, modelo, compartimento, data instalacao, ciclos personalizados (opcional)
- [x] Botoes de acao rapida por midia: "Limpei", "Troquei", "Enxaguei" (chama POST /action)
- [x] Secao "Precisa de Atencao" no topo: midias vencidas ou proximas do vencimento (da API /alerts)
- [x] Historico de acoes ao expandir midia (accordion)
- [x] Zustand store e funcoes de API tipadas
- [x] Midias aposentadas em secao colapsavel separada
- [x] Testes para componentes principais

## Contexto Tecnico

- Spec: `docs/dev/MAINTENANCE_AND_ROUTINES.md` secoes 3.4 e 8
- Wireframe de referencia: secao 3.4 do spec
- Pagina existente: `frontend/src/app/(authenticated)/maintenance/page.tsx` — adicionar nova tab
- Componentes em `frontend/src/components/maintenance/` (criar diretorio se necessario)
- Seguir Design System existente: cards com rounded-xl, badges, cn(), lucide-react icons
- API layer: `frontend/src/lib/api/maintenance.ts` — adicionar funcoes de filter-media
- Store: `frontend/src/stores/maintenance-store.ts` — adicionar state de filter-media

## Notas de Progresso

### [2026-02-20 14:45] claude-code
Implementacao ja estava completa no codigo. Validacao dos criterios:
- `maintenance/page.tsx`: tab "Midias" integrada (tipo `Tab = "tpa" | "maintenance" | "midias"`)
- 6 componentes em `components/maintenance/filter-media/`: filter-media-tab, filter-media-card, filter-media-add-dialog, filter-media-alerts, filter-media-log, filter-media-status-badge
- `lib/api/filter-media.ts`: 8 funcoes de API tipadas (CRUD + action + log + alerts + types)
- `stores/filter-media-store.ts`: Zustand store com loading, actionLoading, error, mediaList, mediaTypes, alerts, logByMediaId
- Agrupamento por categoria (mechanical/chemical/biological) com headings em PT-BR
- Card com tipo, marca, compartimento, instalacao, proxima acao, barra de progresso com cores (ok/warn/crit)
- Dialog de adicao/edicao com selecao de tipo por optgroup, campos opcionais de ciclo
- Botoes de acao rapida: "Limpei", "Troquei", "Enxaguei" com loading individual
- Secao "Precisa de Atencao" com alertas (warning/info) da API /alerts
- Historico colapsavel (accordion) lazy-loaded por midia
- Secao "Aposentadas" colapsavel para midias com status=retired
- 30 testes passando: 10 (add-dialog) + 14 (filter-media-tab) + 6 (maintenance-page-tabs)
- 0 regressoes

### [2026-02-20 15:32] codex
QA de review concluido com sucesso:
- Ajuste de tipagem no frontend para remover cast inseguro entre `Record<string, unknown>` e `FilterMediaCreateData`.
- Testes frontend da feature executados: 30/30 passando (`filter-media-add-dialog`, `filter-media-tab`, `maintenance-page-tabs`).
- Typecheck frontend executado com sucesso (`npx tsc --noEmit`).
Sem regressao detectada no escopo da task.
