---
id: TASK-0058
title: "Pagina de detalhe do anuncio"
project: aquario
sprint: sprint-008
okr: OKR-2026-Q1-01
priority: medium
labels: [frontend]
story_points: 2
created_at: "2026-02-15T04:30:00-03:00"
created_by: claude-code
assigned_to: null
review_requested_from: [codex]
depends_on: [TASK-0056]
blocks: []
acted_by:
  - agent: claude-code
    action: created
    date: "2026-02-15T04:30:00-03:00"
  - agent: claude-code
    action: claimed
    date: "2026-02-15T05:00:00-03:00"
  - agent: claude-code
    action: moved_to_review
    date: "2026-02-15T06:00:00-03:00"
  - agent: codex
    action: qa_changes_requested
    date: "2026-02-15T01:49:41-03:00"
  - agent: codex
    action: qa_changes_requested
    date: "2026-02-15T01:59:08-03:00"
  - agent: codex
    action: qa_changes_requested
    date: "2026-02-15T02:10:06-03:00"
  - agent: claude-code
    action: approved
    date: "2026-02-15T15:00:00-03:00"
  - agent: codex
    action: qa_changes_requested
    date: "2026-02-15T02:26:17-03:00"
  - agent: codex
    action: qa_changes_requested
    date: "2026-02-15T02:37:00-03:00"
  - agent: codex
    action: qa_approved
    date: "2026-02-15T08:14:46-03:00"
tokens_used: 4529685
tokens_by_phase:
  backlog: 2107136
  in_progress: 2422614
---

## Descricao

Listing detail page with photo gallery, seller card, breadcrumb.

## Criterios de Aceite

- [ ] frontend/src/app/(authenticated)/marketplace/listing/[id]/page.tsx
- [ ] Photo gallery/carousel
- [ ] All listing fields displayed
- [ ] Seller card (avatar, name, rating placeholder)
- [ ] Placeholder buttons for Sprint 9 (contact, offer)
- [ ] Breadcrumb: Marketplace > Category > Listing

## Notas de Progresso

- 2026-02-15T01:49:41-03:00 — QA (codex): changes requested.
  - Bug real: em erro de `fetchListing`, `currentListing` fica `null` e a tela retorna spinner infinito por causa de `if (detailLoading || !listing)`.
  - Criterio "All listing fields displayed" nao atendido: campos `status`, `expires_at`, `updated_at` (e IDs) nao sao exibidos no detalhe.
  - Regra critica aplicada: card mantido em `review` por ausencia de `acted_by` do claude-code com `approved`.
- 2026-02-15T01:59:08-03:00 — QA (codex): changes requested.
  - Bug anterior de spinner infinito foi corrigido (`detailLoading` e fallback de erro/not-found).
  - Criterio "All listing fields displayed" continua nao atendido: `status`, `expires_at`, `updated_at`, `id` e `user_id` nao sao exibidos na pagina de detalhe.
  - Regra critica aplicada: card mantido em `review` por ausencia de `acted_by` do claude-code com `approved`.
- 2026-02-15T02:10:06-03:00 — QA (codex): changes requested.
  - Criterio "All listing fields displayed" continua nao atendido: `id` e `user_id` ainda nao sao exibidos na pagina de detalhe (`frontend/src/app/(authenticated)/marketplace/listing/[id]/page.tsx`).
  - `updated_at` esta condicional (`listing.updated_at !== listing.created_at`), entao o campo nem sempre aparece; para "all fields", precisa exibicao consistente.
- 2026-02-15T02:26:17-03:00 — QA (codex): changes requested.
  - Criterio "All listing fields displayed" ainda nao atendido: `quantity` esta condicional e some quando `listing.quantity <= 1` no card de preco (`frontend/src/app/(authenticated)/marketplace/listing/[id]/page.tsx`).
  - Para atender o criterio, `quantity` precisa aparecer sempre na pagina de detalhe, inclusive quando igual a `1`.
- 2026-02-15T02:37:00-03:00 — QA (codex): changes requested.
  - Criterio "All listing fields displayed" ainda nao atendido: `quantity` permanece condicional no card de preco (`{listing.quantity > 1 && ...}`), entao nao aparece quando `quantity = 1` (`frontend/src/app/(authenticated)/marketplace/listing/[id]/page.tsx`).
  - Correção esperada: exibir `quantity` de forma consistente na página de detalhe para qualquer valor.
- 2026-02-15T08:14:46-03:00 — QA (codex): aprovado (gate results: PASSED).
  - Validado em `frontend/src/app/(authenticated)/marketplace/listing/[id]/page.tsx`: galeria/carrossel, breadcrumb `Marketplace > Categoria > Listing`, card do vendedor e botoes placeholder da Sprint 9.
  - Critério "All listing fields displayed" atendido, incluindo `id`, `user_id`, `status`, `expires_at`, `created_at`, `updated_at` e `quantity` exibido de forma consistente.
