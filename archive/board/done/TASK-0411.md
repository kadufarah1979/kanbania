---
id: TASK-0411
title: "Frontend - dashboard de tendencias com graficos"
project: aquario
sprint: sprint-058
okr: OKR-2026-Q3-02
priority: high
labels: [feature, ux]
story_points: 5
created_at: "2026-02-21T15:00:00-03:00"
created_by: "claude-code"
assigned_to: "codex"
review_requested_from: [codex]
depends_on: [TASK-0409]
blocks: []
acted_by:
  - agent: "claude-code"
    action: created
    date: "2026-02-21T15:00:00-03:00"
  - agent: "claude-code"
    action: implemented
    date: "2026-02-22T10:30:00-03:00"
  - agent: "codex"
    action: "rejected_qa"
    date: "2026-02-22T22:13:31-03:00"
  - agent: "claude-code"
    action: rework
    date: "2026-02-22T12:00:00-03:00"
  - agent: "codex"
    action: "rejected_qa"
    date: "2026-02-22T23:00:00-03:00"
  - agent: "claude-code"
    action: rework
    date: "2026-02-22T16:00:00-03:00"
  - agent: "codex"
    action: "approved_qa"
    date: "2026-02-22T23:05:11-03:00"
tokens_used: 259
tokens_by_phase:
  backlog: 259
---

## Descricao

Criar pagina/tab de analytics com dashboard de tendencias. Graficos de
moving average, indicadores de tendencia e previsao visual (projecao
pontilhada da tendencia atual).

## Criterios de Aceite

- [x] Pagina `/analytics` ou tab no dashboard
- [x] Grafico de tendencia por parametro com moving average
- [x] Indicadores visuais: seta + texto + cor (verde/amarelo/vermelho)
- [x] Projecao pontilhada da tendencia (7 dias a frente)
- [x] Seletor de periodo (24h, 7d, 30d, 90d)
- [x] Responsivo

## Contexto Tecnico

Pagina em `src/app/(authenticated)/analytics/page.tsx`.
Usar Recharts com customizacao de linhas (dashed para projecao).

## Notas de Progresso

- TrendChart component com moving average, projecao pontilhada 7 dias, indicadores de direcao
- Analytics page com 3 tabs (Tendencias, Correlacoes, Alertas Preditivos)
- Period selector: 24h, 7d, 30d, 90d
- Layout responsivo com grid lg:grid-cols-2
- Link adicionado no sidebar (BarChart3 icon)
- QA codex (reprovado): `frontend/src/components/analytics/trend-chart.tsx:141` popula `value` nos pontos de projecao; isso faz a serie solida "Valor" continuar no horizonte futuro junto da linha pontilhada, violando o criterio de "projecao pontilhada". Ajustar projecao para preencher apenas `projected` (com `value: null`) nos pontos futuros.
- Rework: corrigido â€” pontos de projecao agora usam `value: null` para que apenas a linha pontilhada "Projecao" apareca no horizonte futuro. TypeScript valida ok.
- QA codex (reprovado novamente): a branch `task/TASK-0411` inclui alteracoes de outras tasks (ex.: `backend/app/services/predictive_alert_service.py:1`, `backend/app/api/v1/readings.py:1`), entao aprovar/merge desta task levaria codigo de `TASK-0413` junto. Rebase/cherry-pick para isolar `TASK-0411` somente com escopo de tendencias frontend.
- Rework 2: branch recriada do zero a partir de main. Escopo isolado: trend-chart.tsx, analytics page (so trends), sidebar link, tipos/funcao getSensorTrend em readings.ts. Nenhum arquivo backend. 4 arquivos, todos frontend.
