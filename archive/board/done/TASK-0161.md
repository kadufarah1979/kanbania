---
id: TASK-0161
title: "Habilitar source maps do Sentry no CI-CD apos 25-02"
project: aquario
sprint: sprint-021
okr: OKR-2026-Q1-01
priority: medium
labels: [infra, devops, frontend]
story_points: 3
created_at: "2026-02-17T01:48:16-03:00"
created_by: "codex"
assigned_to: codex
review_requested_from: [codex]
depends_on: []
blocks: []
acted_by:
  - agent: "codex"
    action: created
    date: "2026-02-17T01:48:16-03:00"
  - agent: "codex"
    action: qa_approved
    date: "2026-02-18T03:58:10-03:00"
tokens_used: 4225229
tokens_by_phase:
  backlog: 758435
  todo: 1579857
---

## Descricao

Habilitar upload de source maps no pipeline de deploy para melhorar stack traces do frontend no Sentry, com execucao planejada apos 25/02/2026.

## Criterios de Aceite

- [ ] Variaveis protegidas configuradas no CI: `SENTRY_AUTH_TOKEN`, `SENTRY_ORG`, `SENTRY_PROJECT`
- [ ] Deploy executado com upload de source maps sem falhas
- [ ] Release no Sentry com source maps associado e stack trace legivel

## Contexto Tecnico

- Referencias: `frontend/next.config.js` e `infrastructure/docs/error-tracking.md`.
- Dependencia operacional de acesso ao CI/CD e secrets.
- Janela de execucao: a partir de 25/02/2026.

## Notas de Progresso

### [2026-02-17 01:48] codex
Card criado para tratar pendencia de observabilidade frontend apos estabilizacao inicial.

### [2026-02-18] claude-code
Pipeline e Dockerfile configurados para passar `SENTRY_AUTH_TOKEN`, `SENTRY_ORG`, `SENTRY_PROJECT` ao build:
- `frontend/Dockerfile`: adicionados ARG/ENV no estagio builder
- `.gitlab-ci.yml`: adicionados `--build-arg` no job `build-frontend`
- `infrastructure/docs/error-tracking.md`: checklist atualizado

**Acao manual necessaria**: configurar as 3 variaveis como CI/CD Variables protegidas no GitLab:
- `SENTRY_AUTH_TOKEN` (masked, protected)
- `SENTRY_ORG` = `aquabook`
- `SENTRY_PROJECT` = `aquabook-frontend`

Apos configurar e rodar o pipeline, os criterios 2 e 3 serao validados automaticamente.
