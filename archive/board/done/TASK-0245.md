---
id: TASK-0245
title: "UI: exibir sync com Kanban e quadro de solicitacoes por status no ConsoleAI"
project: consoleai
sprint: sprint-031
okr: null
priority: high
labels: [frontend, streamlit, workflow]
story_points: 3
created_at: "2026-02-19T03:18:35-03:00"
created_by: codex
assigned_to: codex
review_requested_from: [codex]
depends_on: []
blocks: []
acted_by:
  - agent: codex
    action: created
    date: "2026-02-19T03:18:35-03:00"
  - agent: codex
    action: claimed
    date: "2026-02-19T03:18:35-03:00"
  - agent: codex
    action: update
    date: "2026-02-19T03:24:19-03:00"
  - agent: codex
    action: move
    date: "2026-02-19T22:57:39-03:00"
tokens_used: 1683609
tokens_by_phase:
  backlog: 1553137
---

## Descricao

Evoluir a tela Workflow do ConsoleAI para melhorar visibilidade operacional: mostrar status de sincronizacao para Kanban quando a solicitacao e aprovada e organizar as solicitacoes em colunas por status (pendente, aprovada, rejeitada), reduzindo ambiguidade para o usuario final.

## Criterios de Aceite

- [x] Workflow renderiza solicitacoes separadas por status em layout de colunas.
- [x] Cada card exibe metadados de sync Kanban (status, tentativas, referencia externa quando existir).
- [x] Solicitacoes aprovadas com falha de sync exibem alerta visual claro.
- [x] UI preserva regras de aprovacao por papel (somente gestor aprova).
- [x] Testes automatizados cobrem a montagem dos dados de sync para a UI.

## Contexto Tecnico

A tabela `task_request_sync_jobs` ja existe e registra `status`, `attempts`, `external_ref` e `last_error`. Falta refletir esses dados na UI Streamlit para acompanhamento operacional.

## Notas de Progresso

### [2026-02-19 03:18] codex
Task criada para proximo incremento de UX do workflow na sprint-031.

### [2026-02-19 03:24] codex
Implementacao concluida no ConsoleAI:
- `src/consoleai/workflow_ui.py`: novo view-model para agrupar solicitacoes por status e derivar estado de sync Kanban (pendente, enviado, falha).
- `src/app.py`: workflow em 3 colunas (pendentes/aprovadas/rejeitadas), com badges/alertas de sync e manutencao do fluxo de aprovacao apenas para gestor.
- `tests/test_workflow_ui.py`: cobertura da montagem de dados para UI, incluindo cenarios de sync enviado/falho/pendente.

Evidencia:
- `env PYTHONPATH=src .venv/bin/python -m unittest -q tests.test_workflow_ui tests.test_workflow_service tests.test_ui_provider_mode`
- Resultado: 18 testes OK.

### [2026-02-19 22:57] codex
Gate de QA concluido para TASK-0245:
- validacao independente no repositorio `/home/carlosfarah/Projects/consoleai`;
- comando executado: `PYTHONPATH=src .venv/bin/python -m pytest -q tests/test_workflow_ui.py tests/test_workflow_service.py tests/test_ui_provider_mode.py`;
- resultado: `23 passed`.
Card aprovado e movido de `review` para `done`.
